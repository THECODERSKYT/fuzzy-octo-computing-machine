name: Serveo TinyProxy Tunnel

on: [workflow_dispatch]

jobs:
  tunnel:
    runs-on: ubuntu-latest
    steps:
    - name: Install TinyProxy
      run: |
        sudo apt update
        sudo apt install tinyproxy -y
        sudo sed -i 's/^Port 8888/Port 8888/' /etc/tinyproxy/tinyproxy.conf
        sudo sed -i 's/^#Allow 127.0.0.1/Allow 0.0.0.0/' /etc/tinyproxy/tinyproxy.conf
        sudo systemctl start tinyproxy
    - name: Start Serveo Tunnel
      run: |
        sudo apt install openssh-client -y
        ssh -o StrictHostKeyChecking=no -R 80:localhost:8888 serveo.net &
        sleep 10
        curl -s https://ifconfig.me
    - name: Keep Alive
      run: |
        while true; do echo "ðŸ’“ Running..."; sleep 300; done
